<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VEG X â€“ Cleaned & Chopped Vegetables</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="css/style.css">

</head>
<body>

<header>VEG X â€“ Cleaned & Chopped Vegetables</header>

<div id="product-list"></div>

<div class="cart-summary">
  <p>Cart Total: â‚¹ <span id="cartTotal">0</span></p>
  <p>Delivery: â‚¹ <span id="deliveryCharges">50</span></p>
  <p>Total Payable: â‚¹ <span id="totalPayable">0</span></p>
</div>

<div class="customer-details">
  <input type="text" id="custName" placeholder="Your Name">
  <input type="text" id="custMobile" placeholder="Mobile Number">
  <input type="text" id="custAddress" placeholder="Address">
  <select id="paymentMode">
    <option value="COD">Cash on Delivery</option>
    <option value="UPI">UPI Payment</option>
  </select>
</div>

<button class="checkout" onclick="checkout()">Checkout on WhatsApp</button>

<script src="js/products.js"></script>
<script>
let cart = [];
let total = 0;
let minOrder = 399;
let deliveryCharge = 50;

function renderProducts(){
  let html = "";
  products.forEach((p,i)=>{
    html += `
      <div class="product">
        <img src="images/products/${p.image}" alt="${p.name}">
        <div class="product-details">
          <b>${p.name}</b><br>
          ${p.weight} â€“ â‚¹${p.price}<br>
          Qty:
          <button onclick="changeQty(${i}, -1)">âˆ’</button>
          <input type="number" id="qty${i}" class="qty" value="1" min="1">
          <button onclick="changeQty(${i}, 1)">+</button>
        </div>
        <button class="add-btn" onclick="addToCart(${i})">Add</button>
      </div>
    `;
  });
  document.getElementById("product-list").innerHTML = html;
}

function changeQty(i, delta){
  let qtyInput = document.getElementById("qty"+i);
  let val = parseInt(qtyInput.value) + delta;
  if(val < 1) val = 1;
  qtyInput.value = val;
}

function addToCart(i){
  let qty = parseInt(document.getElementById("qty"+i).value);
  let item = products[i];
  let cost = item.price * qty;
  cart.push({name:item.name, weight:item.weight, qty:qty, price:item.price, total:cost});
  updateCart();
}

function updateCart(){
  total = cart.reduce((acc, item) => acc + item.total, 0);
  let delivery = total >= minOrder ? 0 : deliveryCharge;
  document.getElementById("cartTotal").innerText = total;
  document.getElementById("deliveryCharges").innerText = delivery;
  document.getElementById("totalPayable").innerText = total + delivery;
}

function checkout(){
  if(cart.length===0){
    alert("Cart is empty");
    return;
  }
  const name = document.getElementById("custName").value;
  const mobile = document.getElementById("custMobile").value;
  const address = document.getElementById("custAddress").value;
  const payment = document.getElementById("paymentMode").value;

  if(!name || !mobile || !address){
    alert("Please fill all details");
    return;
  }

  let delivery = total >= minOrder ? 0 : deliveryCharge;
  let msg = `ðŸ›’ VEG X Order
Customer: ${name}
Mobile: ${mobile}
Address: ${address}
Payment: ${payment}

Order Details:
`;

  cart.forEach(item=>{
    msg += `${item.name} ${item.weight} x${item.qty} = â‚¹${item.total}\n`;
  });

  msg += `\nCart Total: â‚¹${total}
Delivery: â‚¹${delivery}
Total Payable: â‚¹${total + delivery}`;

  window.open("https://wa.me/917208487215?text="+encodeURIComponent(msg));
}

renderProducts();
</script>

</body>
</html>
